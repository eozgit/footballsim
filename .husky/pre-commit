# Fix: Use -- to prevent printf from interpreting dashes as options
printf "\n\033[1;36mğŸš€ STARTING PRE-COMMIT MISSION CHECK...\033[0m\n"
printf -- "----------------------------------------------\n"

# 1. Run Tests
printf "\033[1;33mğŸ§ª Step 1: Running Vitest (Silent Mode)...\033[0m\n"
npm run test:precommit

if [ $? -ne 0 ]; then
  printf "\n\033[1;31mâŒ ABORT: Tests failed. Fix the logic before committing!\033[0m\n"
  printf -- "----------------------------------------------\n"
  exit 1
fi

# 2. Run Lint-Staged
printf "\033[1;32mâœ¨ Step 2: Polishing code (Lint-staged)...\033[0m\n"
npx lint-staged

if [ $? -eq 0 ]; then
  printf "\n\033[1;32mâœ… SUCCESS: All systems go. Commit accepted.\033[0m\n"
  printf -- "----------------------------------------------\n"
else
  exit 1
fi
